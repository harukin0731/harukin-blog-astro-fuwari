---
title: AT.Card(セキュリティキー)でLinuxHelloの夢を見る
published: 2022-04-16
tags: ["Archive","Gadget","Linux","ATKey"]
category: Diary
image: https://livedoor.blogimg.jp/harukin0731/imgs/4/d/4dfbdd74-s.jpg
draft: false
---



どうもですです。はるきんでございます。<br>最近、仕事で要求されたりネット上がきな臭かったりするんでU2Fキーを購入することに。<br>ただ、セキュリティキーってそれさえあれば簡単にログインできるサイトもあったり、その物がある場合のセキュリティーって、むしろ低下してたりするんですよね。テストで渡されたYubicoを触ってるうちにそんなことに気がついて、実運用ではもう少しセキュアなキーがいいなぁと思った<span style="color: rgb(204, 204, 204);">(という体で変なものを買ってみたかった) </span>のでこの変なカードを買ってみたのです。<br><br><iframe scrolling="no" style="height: 120px; width: 580px; max-width: 100%; vertical-align:top;" src="https://richlink.blogsys.jp/embed/7fdd6128-d429-371c-859b-ef4316b020ad" frameborder="0"></iframe>
<br>-----<br><br><br>さて、見た目はこんな感じ。<br><a target="_blank" title="IMG_3603" href="https://livedoor.blogimg.jp/harukin0731/imgs/4/d/4dfbdd74.jpg"><img class="pict" alt="IMG_3603" src="https://livedoor.blogimg.jp/harukin0731/imgs/4/d/4dfbdd74-s.jpg" width="480" hspace="5" height="640" border="0"><br></a><a target="_blank" title="IMG_3604" href="https://livedoor.blogimg.jp/harukin0731/imgs/f/6/f6546c75.jpg"><img class="pict" alt="IMG_3604" src="https://livedoor.blogimg.jp/harukin0731/imgs/f/6/f6546c75-s.jpg" width="480" hspace="5" height="360" border="0"></a><br>縦横は本当にクレジットカードそのままの形。<br><br><a target="_blank" title="1650051259118" href="https://livedoor.blogimg.jp/harukin0731/imgs/0/e/0e8337c1.jpg"><img class="pict" alt="1650051259118" src="https://livedoor.blogimg.jp/harukin0731/imgs/0/e/0e8337c1-s.jpg" width="480" hspace="5" height="216" border="0"></a><br>厚さが通常のクレカ(エンボス無し)4枚ちょいでちょっとぶ厚い。<br><br><a target="_blank" title="1650051259095" href="https://livedoor.blogimg.jp/harukin0731/imgs/5/0/50794fe4.jpg"><img class="pict" alt="1650051259095" src="https://livedoor.blogimg.jp/harukin0731/imgs/5/0/50794fe4-s.jpg" width="480" hspace="5" height="639" border="0"></a><br>いつも使ってるカードケースも入らないことはない、といった感じ。<br><br><br>具体的なスペックとしては、Bluetooth Low Energy での近距離無線通信、NFCでの非接触通信、USB-Aでの接触通信の三種類。ここ最近のトレンドのtype-Cが無いのはどうなんだろう、とは思ったけど、まぁNFCがあるのでスマホ関係はなんとかなるか。と思って購入してみました。まぁ、typeCをカードタイプってのは不可能だし、普通にtypeCモデルはまだ高いのでA to Cアダプタを買ったほうが良いかな？<br>指紋認証が実装されているので、既存の問題は排除できるのが一番の利点であり惹かれたポイント。また、普通のキータイプやUSBメモリのようなヤツら、無くしそうだよな、という感想が先に来てたのでカードタイプというのは自分の需要とマッチしていたのです。<br><br>まず利用にはセットアップが必要なので、各OS向けのコンパニオンアプリを利用する。<br>公式サイトのマニュアルに書いてあるので、ここでは省略するとしてちょっと代用となるTipsを一つ。<br><br>最近のu2f汎用ドライバ関連はもうLinuxにも搭載されているので、コンパニオンアプリの代用はLinuxでも可能だったりする。一番簡単な例が、Chromiumを利用する方法だ。<br><a target="_blank" title="Screenshot" href="https://livedoor.blogimg.jp/harukin0731/imgs/a/8/a8ae8d54.png"><img class="pict" alt="Screenshot" src="https://livedoor.blogimg.jp/harukin0731/imgs/a/8/a8ae8d54-s.png" width="480" hspace="5" height="362" border="0"></a><br>Chromiumの設定→プライバシーとセキュリティ<br><br><a target="_blank" title="Screenshot" href="https://livedoor.blogimg.jp/harukin0731/imgs/7/e/7e80b9ff.png"><img class="pict" alt="Screenshot" src="https://livedoor.blogimg.jp/harukin0731/imgs/7/e/7e80b9ff-s.png" width="480" hspace="5" height="362" border="0"></a><br>→セキュリティーキーの管理<br><br><a target="_blank" title="Screenshot" href="https://livedoor.blogimg.jp/harukin0731/imgs/b/1/b1ce2618.png"><img class="pict" alt="Screenshot" src="https://livedoor.blogimg.jp/harukin0731/imgs/b/1/b1ce2618-s.png" width="480" hspace="5" height="363" border="0"></a><br>ここで、指紋が文字通りの指紋データとなり、ここで指紋の追加登録や削除が可能。<br>ぶっちゃけ、ロックされてもこれでなんとかなる。ロックされたりしたらここでPIN入力して復旧しよう。<br><br>ところで、こいつには指紋認証があるから折角なら指紋を活用したログインをしてみたくなる。<br>Windowsではストアでcompanionをインストールして設定するとWindows Helloでログインに利用することができる。macでも使えるようだ。ただ、Windows10では動くもののWindows11では動かないし、macOS Montereyでも動かない。まぁ、まだソフトのアップデートが降ってきてないようなので気長に待つか。それはそれとして、私はLinuxで使いたいのだ。できないかな、と色々調べているとu2fを活用した手法でいけるようだ。手筈はNextcloud Collectiveにメモ書きしたのでとりあえず置いておこう。<br><iframe scrolling="no" style="height: 120px; width: 580px; max-width: 100%; vertical-align:top;" src="https://richlink.blogsys.jp/embed/50e2489c-83b7-391e-ac53-27d6c81b8d0f" frameborder="0"></iframe>
<br><br>簡単に説明すると、Linuxの認証システムを司っているpam(<a style="background-image: url(&quot;https://wiki.archlinux.jp/resources/src/mediawiki.skinning/images/external-ltr.png&quot;); background-position: right center; background-size: initial; background-repeat: no-repeat; background-attachment: initial; background-origin: initial; background-clip: initial; padding-right: 13px; font-weight: bold; font-family: sans-serif; font-size: 14px; color: rgb(153, 153, 153) !important;" href="http://www.linux-pam.org/" class="external text" rel="nofollow">Linux Pluggable Authentication Modules</a>)で設定されているログイン認証の手順に割り込みU2F認証をさせる、ということらしい。<br>それぞれの手持ちのログインマネージャーの設定ファイルがあるので、そこに書き込んでやればおけおけ。<br><br><img class="pict" alt="IMG" src="https://livedoor.blogimg.jp/harukin0731/imgs/4/e/4e18a000.gif" width="320" hspace="5" height="180" border="0"><br>ロック解除要求のタイミングで、カードの認証要求がされて指紋認証に成功するとロックが解除される。<br>もしカードが無かったら、パスワードの認証を要求される。これ、ええやん。<br><br>さて、これができたところで、カードの居場所が確定してなかったらダメなので、いい感じのカードの居場所を作成してみたんですよ。<br><br><a target="_blank" title="IMG_3605" href="https://livedoor.blogimg.jp/harukin0731/imgs/2/c/2cb2d953.jpg"><img class="pict" alt="IMG_3605" src="https://livedoor.blogimg.jp/harukin0731/imgs/2/c/2cb2d953-s.jpg" width="480" hspace="5" height="640" border="0"></a><br><span style="font-size: 150%;">どう？よくない？？</span><br>L字型のUSB拡張端子を購入したので、裏を適当に両面テープで貼り付けて机に固定。<br>下からケーブルをいい感じに伸ばしてここにもってきて、カードの来る部分に高さ調整役の100均の滑り止めを貼ってマウンターとしました。シンプルだけど、個人的にはなかなかいい感じかな、と。<br>これで<br><br><a target="_blank" title="IMG_3606" href="https://livedoor.blogimg.jp/harukin0731/imgs/7/7/77780c45.jpg"><img class="pict" alt="IMG_3606" src="https://livedoor.blogimg.jp/harukin0731/imgs/7/7/77780c45-s.jpg" width="480" hspace="5" height="640" border="0"></a><br>こうなる。ええやん。これで机の縁に手を持っていけば、簡単に指紋認証ができる。場所の定位置も確保されているから、帰ってきたらここに刺して、みたいな芸当が可能になるのだ！<br><br>完全にこれWindowsHelloなんだよ....ええっすよこれ.....オヌヌメ.....どうっすか....いいっすよこれ....<br><br>
